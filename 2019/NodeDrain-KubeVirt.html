<!doctype html>
<html lang="en">

  <head>
    <!-- Adding Adobe Analytics -->
    <script id="dpal" src="//www.redhat.com/ma/dpal.js" type="text/javascript"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1, shrink-to-fit=no" >
    <meta name="go-import" content="kubevirt.io/kubevirt git https://github.com/kubevirt/kubevirt">
    <meta name="go-import" content="kubevirt.io/client-go git https://github.com/kubevirt/client-go">
    <meta name="go-import" content="kubevirt.io/containerized-data-importer git https://github.com/kubevirt/containerized-data-importer">
    <meta name="go-import" content="kubevirt.io/hostpath-provisioner git https://github.com/kubevirt/hostpath-provisioner">
    <meta name="go-import" content="kubevirt.io/hostpath-provisioner-operator git https://github.com/kubevirt/hostpath-provisioner-operator">
    <meta name="go-import" content="kubevirt.io/qe-tools git https://github.com/kubevirt/qe-tools">
    <meta name="go-import" content="kubevirt.io/machine-remediation git https://github.com/kubevirt/machine-remediation">
    <meta name="go-import" content="kubevirt.io/cloud-provider-kubevirt git https://github.com/kubevirt/cloud-provider-kubevirt">
    <meta name="go-import" content="kubevirt.io/controller-lifecycle-operator-sdk git https://github.com/kubevirt/controller-lifecycle-operator-sdk">
    <meta name="go-import" content="kubevirt.io/ssp-operator git https://github.com/kubevirt/ssp-operator">
    <meta name="go-import" content="kubevirt.io/cpu-nfd-plugin git https://github.com/kubevirt/cpu-nfd-plugin">
    <meta name="go-import" content="kubevirt.io/containerized-data-importer-api git https://github.com/kubevirt/containerized-data-importer-api">
    <meta name="go-import" content="kubevirt.io/api git https://github.com/kubevirt/api">
    <meta name="go-import" content="kubevirt.io/node-maintenance-operator git https://github.com/kubevirt/node-maintenance-operator">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicon/site.webmanifest">
    <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification" content="eaETLLM6xObn1li9l9eU8lNIBgBpU0OQLXV1faU1svE" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://kubevirt.io//2019/NodeDrain-KubeVirt.html">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
    
    <title>Node Drain in KubeVirt | KubeVirt.io</title>
    <!-- # Opengraph protocol properties: https://ogp.me/ -->
    <meta name="author" content="DirectedSoul" >
    <meta property="og:type" content="article" >
    <meta name="twitter:card" content="summary">
    <meta name="description" content="Evicting VM's using Node Drain Functionality">
    <meta name="keywords" content="node drain, eviction, nmo" >
    <meta property="og:title" content="Node Drain in KubeVirt | KubeVirt.io">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://kubevirt.io//2019/NodeDrain-KubeVirt.html" >
    <meta property="og:image" content="https://kubevirt.io//assets/images/KubeVirt_logo_color.png">
    <meta property="og:description" content="Evicting VM's using Node Drain Functionality" >
    <meta property="og:site_name" content="KubeVirt.io" >
    <meta property="og:article:author" content="DirectedSoul" >
    <meta property="og:article:published_time" content="2019-07-30 00:00:00 +0000" >
    <meta name="twitter:title" content="Node Drain in KubeVirt | KubeVirt.io">
    <meta name="twitter:description" content="Evicting VM's using Node Drain Functionality">

    <link type="application/atom+xml" rel="alternate" href="https://kubevirt.io//feed.xml" title="KubeVirt.io" />
    <script src="//code.jquery.com/jquery.min.js"></script>
    
    <!-- Photoswipe.com gallery-->

    <!-- Core CSS file -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.css">

    <!-- Skin CSS file (styling of UI - buttons, caption, etc.)
        In the folder of skin CSS file there are also:
        - .png and .svg icons sprite,
        - preloader.gif (for browsers that do not support CSS animations) -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css">
</head>


  <body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" role="navigation">
        <a class="navbar-brand" href="/">
    <img src="/assets/images/KubeVirt_logo_color.svg" class="navbar-brand-image d-inline-block align-top" alt="KubeVirt.io">
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-th-large"></i>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav">
      

      
        <li  class="nav-item active" >
          <a class="nav-link text-uppercase" href="/blogs/">Blogs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/videos/">Videos</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/gallery/">Gallery</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="//kubevirt.io/user-guide">Docs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/labs/">Labs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/community/">Community</a>
        </li>
      

      <li class='nav-item'>
        <form action="/search.html" class="nav-item__search" method="get" autocomplete="off">
          <div class="autocomplete" style="width:150px;">
            <input type="text" id="search-input" class="docs-search--input" placeholder="search term" name="query">
          </div>
          <input id="search-button" type="submit" value="🔍" disabled='true'>
        </form>
      </li>

    </ul>
  </div>
<script>
function autocomplete(inp, arr) {
  /*the autocomplete function takes two arguments,
  the text field element and an array of possible autocompleted values:*/
  var currentFocus;
  /*execute a function when someone writes in the text field:*/
  inp.addEventListener("input", function(e) {
      var a, b, i, val = this.value;
      /*close any already open lists of autocompleted values*/
      closeAllLists();
      if (!val) { return false;}
      currentFocus = -1;
      /*create a DIV element that will contain the items (values):*/
      a = document.createElement("DIV");
      a.setAttribute("id", this.id + "autocomplete-list");
      a.setAttribute("class", "autocomplete-items");
      /*append the DIV element as a child of the autocomplete container:*/
      this.parentNode.appendChild(a);
      /*for each item in the array...*/
      for (i = 0; i < arr.length; i++) {
        /*check if the item starts with the same letters as the text field value:*/
        if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
          /*create a DIV element for each matching element:*/
          b = document.createElement("DIV");
          /*make the matching letters bold:*/
          b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
          b.innerHTML += arr[i].substr(val.length);
          /*insert a input field that will hold the current array item's value:*/
          b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
          /*execute a function when someone clicks on the item value (DIV element):*/
              b.addEventListener("click", function(e) {
              /*insert the value for the autocomplete text field:*/
              inp.value = this.getElementsByTagName("input")[0].value;
              /*close the list of autocompleted values,
              (or any other open lists of autocompleted values:*/
              closeAllLists();
          });
          a.appendChild(b);
        }
      }
  });
  /*execute a function presses a key on the keyboard:*/
  inp.addEventListener("keydown", function(e) {
      document.getElementById("search-button").disabled= undefined;
      var x = document.getElementById(this.id + "autocomplete-list");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode == 40) {
        /*If the arrow DOWN key is pressed,
        increase the currentFocus variable:*/
        currentFocus++;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 38) { //up
        /*If the arrow UP key is pressed,
        decrease the currentFocus variable:*/
        currentFocus--;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 13) {
        /*If the ENTER key is pressed, prevent the form from being submitted,*/
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (x) {
            x[currentFocus].click();
            e.preventDefault();
          }
        }
        if (document.getElementById("search-input").value == "") {
          e.preventDefault();
        }
      }
  });
  function addActive(x) {
    /*a function to classify an item as "active":*/
    if (!x) return false;
    /*start by removing the "active" class on all items:*/
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    /*add class "autocomplete-active":*/
    x[currentFocus].classList.add("autocomplete-active");
  }
  function removeActive(x) {
    /*a function to remove the "active" class from all autocomplete items:*/
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("autocomplete-active");
    }
  }
  function closeAllLists(elmnt) {
    /*close all autocomplete lists in the document,
    except the one passed as an argument:*/
    var x = document.getElementsByClassName("autocomplete-items");
    for (var i = 0; i < x.length; i++) {
      if (elmnt != x[i] && elmnt != inp) {
      x[i].parentNode.removeChild(x[i]);
    }
  }
}
/*execute a function when someone clicks in the document:*/
document.addEventListener("click", function (e) {
    closeAllLists(e.target);
});
}
</script>

<script>
var mykeywords = ["libvirt", "KubeVirt", "ClearContainers", "virtlet", "CRI", "OpenStack", "ovirt", "release notes", "changelog", "hilights", "network", "flannel", "kubevirt-ansible", "Skydive", "openshift", "glusterfs", "heketi", "virtual machine", "weavenet", "custom resources", "kubevirt objects", "objects", "VirtualMachine", "api", "rbac", "roles", "storage", "ovn", "kubetron", "neutron", "vscode", "development", "debug", "istio", "iptables", "tproxy", "service mesh", "ebtables", "docker", "container", "build", "multus", "roadmap", "kvm", "qemu", "device plugins", "unit testing", "review", "hugepages", "kubevirtci", "ci-cd", "cicd", "memory", "overcommitment", "networking", "CNI", "multiple networks", "ovs-cni", "import", "clone", "upload", "disk image", "cdi", "datavolumes", "volume types", "serviceaccount", "ignition", "coreos", "rhcos", "kubecon", "conference", "gcp", "autodeployer", "metrics", "prometheus", "grafana", "federation", "kubefed", "multicluster", "HCO", "hyperconverged operator", "ansible", "vagrant", "lifecycle", "virtual machines", "website", "community", "vm import", "node drain", "eviction", "nmo", "condition types", "Condition types", "CNCF", "sandbox", "lab", "cri-o", "quickstart", "homelab", "kubernetes", "kubevirt installation", "rook", "ceph", "ntp", "chronyd", "prow", "infrastructure", "kubevirt-tutorial", "CI-CD", "continuous integration", "jenkins", "noVNC", "console", "KubeCon", "cloudnativecon", "America", "talk", "gathering", "contra-lib", "admin", "operations", "create vm", "start vm", "connect to console", "connect to ssh", "stop vm", "remove vm", "operator manual", "basic operations", "laboratory", "installing kubevirt", "use kubevirt", "admin operations", "CDI", "containerized data importer", "octant", "okd", "openshift console", "cockpit", "user interface", "web interface", "virtVNC", "OKD console", "kubevirt upgrade", "upgrading", "OpenShift web console", "OKD", "video", "virtual machine management", "NUMA", "CPU pinning", "QEMU", "KVM", "GPU", "NVIDIA", "GPU workloads", "pass-through", "passthrough", "kubevirt", "Microsoft Windows kubernetes", "Microsoft Windows container", "Windows", "VM", "Advanced VM scheduling", "affinity", "scheduling", "topologyKeys", "Live Migration", "design", "architecture", "security", "operation", "images", "Kubernetes", "windows", "common-templates", "minikube", "addons", "oVirt", "kubevirt-hyperconverged", "cnao", "cluster-network-addons-operator", "kubernetes-nmstate", "nmstate", "bridge", "containerDisk", "registry", "composer-cli", "virt-customize", "builder tool", "prometheus-operator", "node-exporter", "monitoring", "event", "Tekton Pipelines", "KubeVirt Tekton Tasks", "vGPU", "Intel", "Fedora", "go", "authentication", "mesh", "AWS", "EC2", "AMI", "real-time", "CPUManager", "live migration", "dedicated network", "Kubevirt", "load-balancer", "MetalLB", "instancetypes", "preferences", "VirtualMachineInstancetype", "VirtualMachinePreference", ]
autocomplete(document.getElementById("search-input"), mykeywords);
</script>

<script src="/js/clipboard.min.js"></script>

    </nav>

    <main role="main" style="margin-top: 60px;">
      <div class="container">
  <div class="row">
    <div class="col">
      <div class="post">
        <header class="post-header">
          <h1></h1>
          <h1 class="post-title">Node Drain in KubeVirt</h1>
          <div class="post-info">
            <span class="post-author">Author: DirectedSoul</span>
            <div>
              <span class="post-category-name">
                Tags: <a href="/tag/node-drain">node drain</a>&nbsp;|&nbsp;<a href="/tag/eviction">eviction</a>&nbsp;|&nbsp;<a href="/tag/nmo">nmo</a>
              </span>
            </div>
            <div>
              <span class="post-meta">Publication Date: July 30, 2019  </span>
            </div>
            <div>
              <span class="post-category-name">
                Category: news
              </span>
            </div>

          </div>
        </header>
        <article class="post-content">
          <h2 id="introduction">Introduction</h2>

<p>In a Kubernetes (k8s) cluster, the control plane(scheduler) is responsible for deploying workloads(<code class="language-plaintext highlighter-rouge">pods</code>, <code class="language-plaintext highlighter-rouge">deployments</code>, <code class="language-plaintext highlighter-rouge">replicasets</code>) on the worker nodes depending on the resource availability. What do we do with the workloads if the need arises for maintaining this node? Well, there is good news, <code class="language-plaintext highlighter-rouge">node-drain</code> feature and node maintenance operator(NMO) both come to our rescue in this situation.</p>

<p>This post discusses evicting the <a href="https://kubevirt.io/user-guide/virtual_machines/virtual_machine_instances/#virtual-machines-instances">VMI</a>(virtual machine instance) and other resources from the node using node drain feature and NMO.</p>

<div class="premonition note"><div class="fa fa-check-square"></div><div class="content"><p class="header">Note</p><p>The environment used for writing this post is based on <a href="https://cloud.redhat.com/openshift/install/aws/installer-provisioned">OpenShift 4</a> with 3 Masters and 3 Worker nodes.</p>


</div></div>
<ul>
  <li><a href="/2019/Hyper-Converged-Operator.html">HyperconvergedClusterOperator</a>: The goal of the hyper-converged-cluster-operator (HCO) is to provide a single entry point for multiple operators (kubevirt, cdi, networking, etc) where users can deploy and configure them in a single object. This operator is sometimes referred to as a “meta operator” or an “operator for operators”. Most importantly, this operator doesn’t replace or interfere with OLM which is an open source toolkit to manage Kubernetes native applications, called Operators, in an effective, automated, and scalable way. Check for <a href="https://coreos.com/blog/introducing-operator-framework">more information about OLM</a>. It only creates operator CRs, which is the user’s prerogative.</li>
</ul>

<p>In our cluster (3 master and 3 nodes) we’ll be able to see something similar to:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$oc</span> get nodes
ip-10-0-132-147.us-east-2.compute.internal   Ready  worker   14m   v1.13.4+27816e1b1
ip-10-0-142-95.us-east-2.compute.internal    Ready  master   15m   v1.13.4+27816e1b1
ip-10-0-144-125.us-east-2.compute.internal   Ready  worker   14m   v1.13.4+27816e1b1
ip-10-0-150-125.us-east-2.compute.internal   Ready  master   14m   v1.13.4+27816e1b1
ip-10-0-161-166.us-east-2.compute.internal   Ready  master   15m   v1.13.4+27816e1b1
ip-10-0-173-203.us-east-2.compute.internal   Ready  worker   15m   v1.13.4+27816e1b1
</code></pre></div></div>

<p>To test the node eviction, there are two methods.</p>

<h2 id="method-1-use-kubectl-node-drain-command">Method 1: Use kubectl node drain command</h2>

<p>Before sending a node into maintenance state it is very much necessary to evict the resources on it, VMI’s, pods, deployments etc. One of the easiest option for us is to stick to the oc adm drain command. For this, select the node from the cluster from which you want the VMIs to be evicted</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc get nodes
</code></pre></div></div>

<p>Here <code class="language-plaintext highlighter-rouge">ip-10-0-173-203.us-east-2.compute.internal</code>, then issue the following command.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc adm drain &lt;node-name&gt; <span class="nt">--delete-local-data</span> <span class="nt">--ignore-daemonsets</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--force</span> <span class="nt">--pod-selector</span><span class="o">=</span>kubevirt.io<span class="o">=</span>virt-launcher
</code></pre></div></div>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--delete-local-data</code> is used to remove any VMI’s that use <code class="language-plaintext highlighter-rouge">emptyDir</code> volumes, however the data in those volumes are ephemeral which means it is safe to delete after termination.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--ignore-daemonsets=true</code> is a must needed flag because when VMI is deployed a daemon set named <code class="language-plaintext highlighter-rouge">virt-handler</code> will be running on each node. DaemonSets are not allowed to be evicted using kubectl drain. By default, if this command encounters a DaemonSet on the target node, the command will fail. This flag tells the command it is safe to proceed with the eviction and to just ignore DaemonSets.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--pod-selector=kubevirt.io=virt-launcher</code> flag tells the command to evict the pods that are managed by kubevirt</p>
  </li>
</ul>

<h3 id="evict-a-node">Evict a node</h3>

<p>If you want to evict all pods from the node just use:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc adm drain &lt;node name&gt; <span class="nt">--delete-local-data</span> <span class="nt">--ignore-daemonsets</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--force</span>
</code></pre></div></div>

<h3 id="how-to-evacuate-vmis-via-live-migration-from-a-node">How to evacuate VMIs via Live Migration from a Node</h3>

<p>If the <code class="language-plaintext highlighter-rouge">LiveMigration</code> feature gate is enabled, it is possible to specify an evictionStrategy on VMIs which will react with live-migrations on specific taints on nodes. The following snippet on a VMI ensures that the VMI is migrated if the <code class="language-plaintext highlighter-rouge">kubevirt.io/drain:NoSchedule</code> taint is added to a node:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spec</span><span class="pi">:</span>
  <span class="na">evictionStrategy</span><span class="pi">:</span> <span class="s">LiveMigrate</span>
</code></pre></div></div>

<p>Once the VMI is created, taint the node with</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl taint nodes foo kubevirt.io/drain<span class="o">=</span>draining:NoSchedule
</code></pre></div></div>

<p>This command will then trigger a migration.</p>

<p>Behind the scenes a <strong>PodDisruptionBudget</strong> is created for each VMI which has an evictionStrategy defined. This ensures that evictions are be blocked on these VMIs and that we can guarantee that a VMI will be migrated instead of shut off.</p>

<h3 id="re-enabling-a-node-after-eviction">Re-enabling a Node after Eviction</h3>

<p>We have seen how to make the node unschedulable, now lets see how to re-enable the node.</p>

<p>The <code class="language-plaintext highlighter-rouge">oc adm drain</code> will result in the target node being marked as unschedulable. This means the node will not be eligible for running new VirtualMachineInstances or Pods.</p>

<p>If target node should become schedulable again, the following command must be run:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc adm uncordon &lt;node name&gt;
</code></pre></div></div>

<h2 id="method-2-use-node-maintenance-operator-nmo">Method 2: Use Node Maintenance Operator (NMO)</h2>

<p>NMO is part of HyperConvergedClusterOperator, so we need to deploy it.</p>

<p>Either check:</p>

<ul>
  <li>the <a href="https://gist.github.com/rthallisey/ed3417bc7f14f264030d26fee4032092">gist for deploying HCO</a></li>
  <li>the <a href="/2019/Hyper-Converged-Operator.html">blog post on HCO</a></li>
</ul>

<p>Here will continue using the gist for demonstration purposes.</p>

<p>Observe the resources that get created after the HCO is installed</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$oc get pods -n kubevirt-hyperconverged
NAME                                               READY   STATUS    RESTARTS   AGE
cdi-apiserver-769fcc7bdf-xgpt8                     1/1     Running   0          12m
cdi-deployment-8b64c5585-gq46b                     1/1     Running   0          12m
cdi-operator-77b8847b96-kx8rx                      1/1     Running   0          13m
cdi-uploadproxy-8dcdcbff-47lng                     1/1     Running   0          12m
cluster-network-addons-operator-584dff99b8-2c96w   1/1     Running   0          13m
hco-operator-59b559bd44-vpznq                      1/1     Running   0          13m
kubevirt-ssp-operator-67b78446f7-b9klr             1/1     Running   0          13m
kubevirt-web-ui-operator-9df6b67d9-f5l4l           1/1     Running   0          13m
node-maintenance-operator-6b464dc85-zd6nt          1/1     Running   0          13m
virt-api-7655b9696f-g48p8                          1/1     Running   1          12m
virt-api-7655b9696f-zfsw9                          1/1     Running   0          12m
virt-controller-7c4584f4bc-6lmxq                   1/1     Running   0          11m
virt-controller-7c4584f4bc-6m62t                   1/1     Running   0          11m
virt-handler-cfm5d                                 1/1     Running   0          11m
virt-handler-ff6c8                                 1/1     Running   0          11m
virt-handler-mcl7r                                 1/1     Running   1          11m
virt-operator-87d7c98b-fvvzt                       1/1     Running   0          13m
virt-operator-87d7c98b-xzc42                       1/1     Running   0          13m
virt-template-validator-76cbbd6f68-5fbzx           1/1     Running   0          12m
</code></pre></div></div>

<p>As seen from above HCO deploys the <code class="language-plaintext highlighter-rouge">node-maintenance-operator</code>.</p>

<p>Next, let’s install a kubevirt CR to start using VM workloads on worker nodes. Please feel free to follow the steps <a href="/quickstart_minikube/#deploy-kubevirt">here</a> and deploy a VMI as explained. Please feel free to check the video that explains the <a href="https://www.youtube.com/watch?v=LLNjyeB-3fI">same</a></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$oc</span> get vms
NAME     AGE     RUNNING   VOLUME
testvm   2m13s   <span class="nb">true</span>
</code></pre></div></div>

<p>Deploy a node-maintenance-operator CR: As seen from above NMO is deployed from HCO, the purpose of this operator is to watch the node maintenance CustomResource(CR) called <code class="language-plaintext highlighter-rouge">NodeMaintenance</code> which mainly contains the node that needs a maintenance and the reason for it. The below actions are performed</p>

<ul>
  <li>If a <code class="language-plaintext highlighter-rouge">NodeMaintenance</code> CR is created: Marks the node as <code class="language-plaintext highlighter-rouge">unschedulable</code>, cordons it and evicts all the pods from that node</li>
  <li>If a <code class="language-plaintext highlighter-rouge">NodeMaintenance</code> CR is deleted: Marks the node as <code class="language-plaintext highlighter-rouge">schedulable</code>, uncordons it, removes pod from maintenance.</li>
</ul>

<p>To install the NMO, please follow upsream instructions at <a href="https://github.com/kubevirt/node-maintenance-operator">NMO</a></p>

<p>Either use HCO to create NMO Operator or deploy NMO operator as shown below</p>

<p>After you follow the instructions:</p>

<ol>
  <li>Create a CRD
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc create <span class="nt">-f</span> deploy/crds/nodemaintenance_crd.yaml
customresourcedefinition.apiextensions.k8s.io/nodemaintenances.kubevirt.io created
</code></pre></div>    </div>
  </li>
  <li>Create the NS
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc create <span class="nt">-f</span> deploy/namespace.yaml
namespace/node-maintenance-operator created
</code></pre></div>    </div>
  </li>
  <li>Create a Service Account:
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc create <span class="nt">-f</span> deploy/service_account.yaml
serviceaccount/node-maintenance-operator created
</code></pre></div>    </div>
  </li>
  <li>Create a ROLE
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc create <span class="nt">-f</span> deploy/role.yaml
clusterrole.rbac.authorization.k8s.io/node-maintenance-operator created
</code></pre></div>    </div>
  </li>
  <li>Create a ROLE Binding
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc create <span class="nt">-f</span> deploy/role_binding.yaml
clusterrolebinding.rbac.authorization.k8s.io/node-maintenance-operator created
</code></pre></div>    </div>
  </li>
  <li>Then finally make sure to add the image version of the NMO operator in the deploy/operator.yml
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>image: quay.io/kubevirt/node-maintenance-operator:v0.3.0
</code></pre></div>    </div>
  </li>
  <li>and then deploy the NMO Operator as shown
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc create <span class="nt">-f</span> deploy/operator.yaml
deployment.apps/node-maintenance-operator created
</code></pre></div>    </div>
  </li>
</ol>

<p>Finally, We can verify the deployment for the NMO Operator as below</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc get deployment <span class="nt">-n</span> node-maintenance-operator
NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
node-maintenance-operator   1/1     1            1           4m23s
</code></pre></div></div>

<p>Now that the NMO operator is created, we can create the NMO CR which puts the node into maintenance mode (this CR has the info about the node-&gt;from which the pods needs to be evicted and the reason for the maintenance)</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">cat deploy/crds/nodemaintenance_cr.yaml</span>

<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kubevirt.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">NodeMaintenance</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">nodemaintenance-xyz</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">nodeName</span><span class="pi">:</span> <span class="s">&lt;Node-Name&gt;</span>
  <span class="na">reason</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Test</span><span class="nv"> </span><span class="s">node</span><span class="nv"> </span><span class="s">maintenance"</span>
</code></pre></div></div>

<p>For testing purpose, we can deploy a sample VM instance as shown:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl apply <span class="nt">-f</span> https://kubevirt.io/labs/manifests/vm.yaml
</code></pre></div></div>

<p>Now start the VM <code class="language-plaintext highlighter-rouge">testvm</code></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./virtctl start testvm
</code></pre></div></div>

<p>We can see that it’s up and running</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get vmis
NAME     AGE   PHASE     IP            NODENAME
testvm   92s   Running   10.131.0.17   ip-10-0-173-203.us-east-2.compute.internal
</code></pre></div></div>

<p>Also, we can see the status:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">kubectl get vmis -o yaml testvm</span>
<span class="s">.</span>
<span class="s">.</span>
<span class="s">.</span>
  <span class="s">interfaces</span><span class="err">:</span>
  <span class="pi">-</span> <span class="na">ipAddress</span><span class="pi">:</span> <span class="s">10.131.0.17</span>
    <span class="na">mac</span><span class="pi">:</span> <span class="s">0a:58:0a:83:00:11</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">migrationMethod</span><span class="pi">:</span> <span class="s">BlockMigration</span>
  <span class="na">nodeName</span><span class="pi">:</span> <span class="s">ip-10-0-173-203.us-east-2.compute.internal</span>    <span class="c1">#NoteDown the nodeName</span>
  <span class="na">phase</span><span class="pi">:</span> <span class="s">Running</span>
</code></pre></div></div>

<p>Note down the node name and edit the <code class="language-plaintext highlighter-rouge">nodemaintenance_cr.yaml</code> file and then issue the CR manifest which sends the node into maintenance.</p>

<p>Now to evict the pods from the node <code class="language-plaintext highlighter-rouge">ip-10-0-173-203.us-east-2.compute.internal</code>, edit the <code class="language-plaintext highlighter-rouge">node-maintenance_cr.yaml</code> as shown:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">cat deploy/crds/nodemaintenance_cr.yaml</span>

<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kubevirt.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">NodeMaintenance</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">nodemaintenance-xyz</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">nodeName</span><span class="pi">:</span> <span class="s">ip-10-0-173-203.us-east-2.compute.internal</span>
  <span class="na">reason</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Test</span><span class="nv"> </span><span class="s">node</span><span class="nv"> </span><span class="s">maintenance"</span>
</code></pre></div></div>

<p>As soon as you apply the above CR, the current VM gets deployed in the other node,</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc apply <span class="nt">-f</span> deploy/crds/nodemaintenance_cr.yaml
nodemaintenance.kubevirt.io/nodemaintenance-xyz created
</code></pre></div></div>

<p>Which immediately evicts the VMI</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get vmis
NAME     AGE   PHASE        IP    NODENAME
testvm   33s   Scheduling

kubectl get vmis
NAME     AGE    PHASE     IP            NODENAME
testvm   104s   Running   10.128.2.20   ip-10-0-132-147.us-east-2.compute.internal
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip-10-0-173-203.us-east-2.compute.internal   Ready,SchedulingDisabled   worker
</code></pre></div></div>

<p>When all of this happens, we can view the changes that are taking place with:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">oc</span><span class="w"> </span><span class="err">logs</span><span class="w"> </span><span class="err">pods/node-maintenance-operator</span><span class="mi">-645</span><span class="err">f</span><span class="mi">757</span><span class="err">d</span><span class="mi">5-89</span><span class="err">d</span><span class="mi">6</span><span class="err">r</span><span class="w"> </span><span class="err">-n</span><span class="w"> </span><span class="err">node-maintenance-operator</span><span class="w">
</span><span class="err">.</span><span class="w">
</span><span class="err">.</span><span class="w">
</span><span class="err">.</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.650298</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"Applying Maintenance mode on Node: ip-10-0-173-203.us-east-2.compute.internal with Reason: Test node maintenance"</span><span class="p">,</span><span class="nl">"Request.Namespace"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"Request.Name"</span><span class="p">:</span><span class="s2">"nodemaintenance-xyz"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.7509086</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"Taints: [{</span><span class="se">\"</span><span class="s2">key</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">node.kubernetes.io/unschedulable</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">effect</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">NoSchedule</span><span class="se">\"</span><span class="s2">},{</span><span class="se">\"</span><span class="s2">key</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">kubevirt.io/drain</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">effect</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">NoSchedule</span><span class="se">\"</span><span class="s2">}] will be added to node ip-10-0-173-203.us-east-2.compute.internal"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.7509348</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"Applying kubevirt.io/drain taint add on Node: ip-10-0-173-203.us-east-2.compute.internal"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.7509415</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"Patchi{"</span><span class="err">level</span><span class="s2">":"</span><span class="err">info</span><span class="s2">","</span><span class="err">ts</span><span class="s2">":1559681430.9903986,"</span><span class="err">logger</span><span class="s2">":"</span><span class="err">controller_nodemaintenance</span><span class="s2">","</span><span class="err">msg</span><span class="s2">":"</span><span class="err">evicting</span><span class="w"> </span><span class="err">pod</span><span class="w"> </span><span class="err">\</span><span class="s2">"virt-controller-b94d69456-b9dkw</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.99049</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">community-operators-5cb68db58-4m66j</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.9905066</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">alertmanager-main-1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.9905581</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">virt-launcher-testvm-q5t7l</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.9905746</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">redhat-operators-6b6f6bd788-zx8nm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.990588</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">image-registry-586d547bb5-t9lwr</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.9906075</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">kube-state-metrics-5bbd4c45d5-sbnbg</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.9906383</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">certified-operators-9f9f6fd5c-9ltn8</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.9908028</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">virt-api-59d7c4b595-dkpvs</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.9906204</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evicting pod </span><span class="se">\"</span><span class="s2">router-default-6b57bcc884-frd57</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"level"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"ts"</span><span class="p">:</span><span class="mf">1559681430.9908257</span><span class="p">,</span><span class="nl">"logger"</span><span class="p">:</span><span class="s2">"controller_nodemaintenance"</span><span class="p">,</span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"evict
</span></code></pre></div></div>

<p>Clearly we can see that the previous node went into <code class="language-plaintext highlighter-rouge">SchedulingDisabled</code> state and the VMI was evicted and placed into other node in the cluster. This demonstrates the node eviction using NMO.</p>

<h2 id="virtualmachine-evictions-notes">VirtualMachine Evictions notes</h2>

<p>The eviction of any VirtualMachineInstance that is owned by a VirtualMachine set to running=true will result in the VirtualMachineInstance being re-scheduled to another node.</p>

<p>The VirtualMachineInstance in this case will be forced to power down and restart on another node. In the future once KubeVirt introduces live migration support, the VM will be able to seamlessly migrate to another node during eviction.</p>

<h2 id="wrap-up">Wrap-up</h2>

<p>The NMO achieved its aim of evicting the VMI’s successfully from the node, hence we can now safely repair/update the node and make it available for running the workloads again once the maintenance is over.</p>

        </article>
        
        

<a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Node Drain in KubeVirt&url=https://www.kubevirt.io/2019/NodeDrain-KubeVirt.html&screen_name=kubevirt" aria-label="Share this on Twitter">
  <i class="fab fa-twitter mr-1"></i> Tweet
</a>
<hr/>


      </div>
    </div>
  </div>
</div>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script src="/js/photoswipe-page.js">
</script>

    </main>

    <footer class="footer" role="footer">
      <div class="container-fluid">
  <div class="row justify-content-between">
    <div class="col-sm-12 col-md-5">
      <p>We are a <a href="https://cncf.io/">Cloud Native Computing Foundation</a> sandbox project.</p>
      <p><a href="https://cncf.io/"><img src="/assets/images/cncf-color.png" alt="Cloud Native Computing Foundation"/></a></p>
    </div>
    <div class="col-sm-12 col-md-5" style="text-align: center;">
      <p class="text-md-right">

        <a href="https://twitter.com/kubevirt" data-toggle="tooltip" data-placement="top" title="Follow us on Twitter!" aria-label="Visit us on Twitter" class="link-social-twitter">
          <i class="fab fa-twitter fa-lg"></i>
        </a>

        <a href="https://kubernetes.slack.com/archives/C8ED7RKFE" data-toggle="tooltip" data-placement="top" title="Join our Slack channel!" class="link-social-slack">
          <i class="fab fa-slack fa-lg"></i>
        </a>

        <a href="https://github.com/kubevirt" data-toggle="tooltip" data-placement="top" title="Check our GitHub!" class="link-social-github">
          <i class="fab fa-github fa-lg"></i>
        </a>

        <a href="https://groups.google.com/forum/#!forum/kubevirt-dev" data-toggle="tooltip" data-placement="top" title="Join our mailing list!" class="link-social-mail">
          <i class="fas fa-envelope fa-lg"></i>
        </a>

        <a href="https://calendar.google.com/calendar/u/0/embed?src=kubevirt@cncf.io" data-toggle="tooltip" data-placement="top" title="See our events calendar!" class="link-social-calendar">
          <i class="fas fa-calendar fa-lg"></i>
        </a>

        <a href="https://www.youtube.com/channel/UC2FH36TbZizw25pVT1P3C3g/videos" data-toggle="tooltip" data-placement="top" title="Subscribe to our YouTube channel!" class="link-social-youtube">
          <i class="fab fa-youtube fa-lg"></i>
        </a>

      </p>
    </div>
  </div>
  <div class="row">
    <div class="col text-sm-left footer-licensing" style="text-align: center;">
      Copyright 2022 The KubeVirt Contributors<br>
      Copyright 2022 The Linux Foundation. All Rights Reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage</a> page.<br>
      This site is powered by <a href="https://www.netlify.com/legal/open-source-policy/">Netlify</a>.
      <p class="privacy-statement text-sm-left" style="text-align: center;">
        <a href="/privacy" class="privacy-statement-link">Privacy Statement</a>
      </p>
  </div>
</div>
<script src="/js/copy.js"></script>

    </footer>

    <script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js" integrity="sha384-3LK/3kTpDE/Pkp8gTNp2gR/2gOiwQ6QaO7Td0zV76UFJVhqLl4Vl3KL1We6q6wR9" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <script src="/js/kubevirt-io.js"></script>
    <!-- Photoswipe -->
    <!-- Core JS file -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.js"></script>
    <!-- UI JS file -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

    <!-- This comes from DTM/DPAL and must be latest entry in body-->

    <script type="text/javascript">
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
            _satellite.pageBottom();
        }
    </script>
  </body>
</html>
